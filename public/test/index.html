<!DOCTYPE html>
<html>
	<head>
		<title>polyworks js module tester</title>
		<link rel="stylesheet" type="text/css" href="css/test.css" />
<!--		<script type="text/javascript" src="../build/js/polyworks.js"></script> -->
		<script type="text/javascript" src="../lib/phaser/phaser.js"></script>

		<script type="text/javascript" src="../src/js/namespace.js"></script>
		<script type="text/javascript" src="../src/js/utils/logger.js"></script>
		<script type="text/javascript" src="../src/js/utils/stage.js"></script>
		<script type="text/javascript" src="../src/js/utils/utils.js"></script>
		<script type="text/javascript" src="../src/js/events/events.js"></script>
		<script type="text/javascript" src="../src/js/events/event_center.js"></script>
		<script type="text/javascript" src="../src/js/third_party/phaser/phaser_animation.js"></script>
		<script type="text/javascript" src="../src/js/third_party/phaser/phaser_physics.js"></script>
		<script type="text/javascript" src="../src/js/third_party/phaser/phaser_sprite.js"></script>
		<script type="text/javascript" src="../src/js/third_party/phaser/phaser_text.js"></script>
		<script type="text/javascript" src="../src/js/displays/display_factory.js"></script>
		<script type="text/javascript" src="../src/js/displays/screen_manager.js"></script>
		<script type="text/javascript" src="../src/js/dom/dom_manager.js"></script>
		<script type="text/javascript" src="../src/js/social/social_manager.js"></script>
	</head>
	<body>
		<div id='game_container'></div>
		<script type="text/javascript">
		var config = {
			gameType: 'phaser',
			aspectRatio: [16, 9],
			screens: [
			{
				id: 'start',
				views: [{
					type: 'PhaserSprite'
				}]
			},
			{
				id: 'play',
				views: [
				{
					type: 'PhaserSprite'
				}]
			},
			{
				id: 'gameOver',
				views: [
				{
					type: 'PhaserSprite'
				}]
			}],
			defaultScreen: 'start'
		};
		var TestGame = (function() {
			var screens = Polyworks.ScreenManager;
			
			function TestGame(config) {
				this.stage = Polyworks.Stage;
				this.stage.init(config.aspectRatio, false, this.onStageInitialized, this);
			}
			
			TestGame.prototype.onStageInitialized = function() {
				trace('Game/onStageInitialized, config = ', config, screens);

				this.phaser = new Phaser.Game(
					this.stage.gameW, 
					this.stage.gameH, 
					Phaser.AUTO, 
					'game_container',
					{ 
						preload: this.preload, 
						create: this.create, 
						update: this.update, 
						render: this.render 
					}
				);
				
				Polyworks.ScreenManager.init(config.screens);
				Polyworks.ScreenManager.activate(config.defaultScreen);
			};
			
			TestGame.prototype.preload = function() {
				trace('Game/preload');
			};
			
			TestGame.prototype.create = function() {
				trace('Game/create');
			};
			
			TestGame.prototype.update = function() {
			};
			
			TestGame.prototype.render = function() {
				// trace('Game/render');
			};
			
			return TestGame;
		}());

		var game = new TestGame(config);
		</script>
	</body>
</html>